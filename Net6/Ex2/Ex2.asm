IO0DIR EQU 0XE0028008
IO0PIN EQU 0XE0028004
IO1CLR EQU 0XE002800C
IO1PIN EQU 0XE0028010

	AREA PROG,CODE,READONLY
		EXPORT __main
__main
    ENTRY
	LDR R1,=IO0DIR
	LDR R0,=0X10FF0000
	STR R0,[R1]
	LDR R1,=IO0DIR
	LDR R1,=0X0F00000
	STR R0,[R1]
	LDR R1,=IO1PIN
	LDR R2,=IO0PIN
	LDR R4,=IO1CLR
BK1 LDR R0,=0X0F00000
    STR R0,[R4]
	LDR R5,[R1]
	AND R5,R5,#0X0F00000
	CMP R5,#0XF0000
	BNE BK1
BK2 BL DELAY
    LDR R5,[R1]
	AND R5,R5,#0XF000
	CMP R5,#0XF0000
	BEQ BK2
	BL DELAY
	LDR R5,[R1]
	AND R5,R5,#0XF0000
	CMP R5,#0XF0000
	BEQ BK2
	LDR R0,=0XE00000
	STR R0,[R1]
	LDR R5,[R1]
	AND R5,R5,#0XF0000
	CMP R5,#0XF0000
	BNE ROW0
	LDR R0,=0XD00000
	STR R0,[R1]
	LDR R5,[R1]
	AND R5,R5,#0XF0000
	CMP R5,#0XF0000
	BNE ROW1
	LDR R0,=0XB00000
	STR R0,[R1]
	LDR R5,[R1]
	AND R5,R5,#0XF0000
	CMP R5,#0XF0000
	BNE ROW2
	LDR R0,=0X700000
	STR R0,[R1]
	LDR R5,[R1]
	AND R5,R5,#0XF0000
	CMP R5,#0XF0000
	BNE ROW3
	B BK2
ROW0 LDR R6,=SEG_CODE0
    B FIND
ROW1 LDR R6,=SEG_CODE1
    B FIND
ROW2 LDR R6,=SEG_CODE2
    B FIND
ROW3 LDR R6,=SEG_CODE3
FIND MOV R8,#16
NXT MOVS R7,R5,LSL R8
    BCC MATCH 
	SUB R8,R8,#1
	ADD R6,R6,#1
	B NXT
MATCH LDR R0,=0X10000000
      LDRB R9,[R6]
	  MOV R9,R9,LSL #16
	  ORR R9,R9,R0
	  STR R9,[R2]
	  B BK1
DELAY 
      LDR R10,=0X2ff
up	  SUBS R10,R10,#1
      BNE up
	  BX LR
SEG_CODE0     DCB 0X3F,0X06,0X5B,0X4F
SEG_CODE1     DCB 0X66,0X6D,0X7D,0X07
SEG_CODE2     DCB 0X7F,0X6F,0X77,0X7C
SEG_CODE3     DCB 0X39,0X5E,0X79,0X71
      END